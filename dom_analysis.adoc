

== 分析・解析

* 入力データ・処理内容・結果出力で一組
  ** 全ての段階を一括管理したい
* 共通のデータ, 処理内容
  ** 再利用可能なパーツとして扱いたい
* 様々なパターンの入力・処理内容の試行
  ** バージョン管理が必要

== Excelの利点と欠点

利点::
  ** データ・解析・出力結果がワンセット
欠点::
  ** (マクロ等使わなければ) 処理内容の可読性が低い
  ** データ・解析・出力結果の再利用が面倒
  ** データと結果を分けるのが面倒
  ** 複雑な計算が面倒

== プログラミングによる解決

.R言語の例
[source,R]
----
# 入力データの読み込みと加工
read.csv("../data/SVB/mineral/EPMA/opx_zoning_compile.csv") %>%
    subset(comment == "1002-9-1C-1_Line1") %>%
    .$Cr2O3 -> y 

lambda <- 0.1 # 正則化項の重み

# FusedLasso法で組成プロファイルのトレンドを抽出するロジック
# 入力データだけに依存
y %>%
    fusedlasso1d %>%
    coef(lambda=lambda) %>%
    tee(function(coef){

        plot(1:length(y), y)
        lines(1:length(y), coef$beta)

    }) %>%
    invisible
----

利点::
  ** 入力データ・解析・出力を抽象化することで再利用可能
  ** コードとして処理内容が可読
  ** テキストなのでバージョン管理が容易
欠点::
  ** 一般に, データ・解析・出力結果を別々に管理する必要 + 
  (ただし, これを可能にするツールはある)

.データ分析などに人気の言語
* Python
* R
* JavaScript
* Matlab (有償)

